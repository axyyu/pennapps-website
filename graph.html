<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="utf-8" />
    <title>debrief</title>

    <link rel="stylesheet" type="text/css" href="fonts/stylesheet.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/loader.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.3.0/mustache.min.js" defer></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" defer></script>
    <script src="js/animations.js" defer></script>
    <script src="https://www.gstatic.com/firebasejs/4.3.0/firebase.js"></script>
	<link rel="stylesheet" type="text/css" href="hover-min.css">
</head>
<body style="margin:0;">
<center>
	<br/>
	<h1 id="entity"></h1>
	<div style="width:100%; height:100px; margin-top:100px;" id="graph">
		<div id="line" style="position:relative;top:45px;left:0;right:0;width:100%;height:10px;background-color:#FF0000;border-radius:5px;background: linear-gradient(to right, red , yellow, green);"></div>
	</div>
	<h3>*Sources with zero sentiment not pictured.</h3>
</center>
<script>
	var pictionary = {
		"CBS":"img/cbs.png",
		"MSNBC":"img/msnbc.png",
		"Breitbart":"img/bb.png",
		"Fox+News":"img/fox.png",
		"ABC":"img/abc.png",
		"CNN":"img/cnn.png",
		"NPR":"img/npr.png",
		"Huffington+Post+US":"img/huffpost.png"
	}
	function get(name){
	if(name=(new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)')).exec(location.search))
		return decodeURIComponent(name[1]);
	}
	firebase.initializeApp({databaseURL: "https://debrief-v2.firebaseio.com"});
	var database = firebase.database();
	var ref = database.ref('topics').child(get("topic"));
	ref.once('value', function(snapshot){
		snapshot.forEach(function(article){
			var imgsrc = pictionary[article.child("source").val()];
			if(imgsrc == null){
				imgsrc = pictionary[article.child("source").val().title.toUpperCase()];
			}
			if(article.val().sentiment.score!=0)
				addSource(Math.round((article.val().sentiment.score+1)*50), imgsrc);
		});
	});
	console.log(get("entity"))
</script>
</body>
</html>